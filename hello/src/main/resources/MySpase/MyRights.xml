<?xml version="1.0" encoding="UTF-8"?>
<xwikidoc>
<web>MySpase</web>
<name>MyRights</name>
<language></language>
<defaultLanguage>en</defaultLanguage>
<translation>0</translation>
<parent></parent>
<creator>XWiki.Admin</creator>
<author>XWiki.Admin</author>
<customClass></customClass>
<contentAuthor>XWiki.Admin</contentAuthor>
<creationDate>1394031569000</creationDate>
<date>1394031569000</date>
<contentUpdateDate>1394031569000</contentUpdateDate>
<version>1.1</version>
<title></title>
<defaultTemplate></defaultTemplate>
<validationScript></validationScript>
<comment></comment>
<minorEdit>false</minorEdit>
<syntaxId>xwiki/2.1</syntaxId>
<hidden>false</hidden>
<class>
<name>MySpase.MyRights</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<MyText>
<customDisplay></customDisplay>
<disabled>0</disabled>
<name>MyText</name>
<number>1</number>
<picker>0</picker>
<prettyName>MyText</prettyName>
<size>30</size>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
</MyText>
</class>
<object>
<class>
<name>MySpase.MyClass</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<category>
<cache>0</cache>
<classname>MySpase.MyCategoryClass</classname>
<customDisplay></customDisplay>
<disabled>0</disabled>
<displayType>select</displayType>
<idField>doc.fullName</idField>
<multiSelect>0</multiSelect>
<name>category</name>
<number>4</number>
<picker>0</picker>
<prettyName>category</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<separators></separators>
<size>1</size>
<sort>none</sort>
<sql></sql>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<valueField>name</valueField>
<classType>com.xpn.xwiki.objects.classes.DBListClass</classType>
</category>
<private_content>
<customDisplay></customDisplay>
<disabled>0</disabled>
<editor>---</editor>
<name>private_content</name>
<number>2</number>
<picker>0</picker>
<prettyName>Private Content</prettyName>
<rows>5</rows>
<size>40</size>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</private_content>
<public_content>
<customDisplay></customDisplay>
<disabled>0</disabled>
<editor>---</editor>
<name>public_content</name>
<number>3</number>
<picker>0</picker>
<prettyName>Public Content</prettyName>
<rows>5</rows>
<size>40</size>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<classType>com.xpn.xwiki.objects.classes.TextAreaClass</classType>
</public_content>
<title>
<customDisplay></customDisplay>
<disabled>0</disabled>
<name>title</name>
<number>1</number>
<picker>0</picker>
<prettyName>title</prettyName>
<size>30</size>
<unmodifiable>0</unmodifiable>
<validationMessage></validationMessage>
<validationRegExp></validationRegExp>
<classType>com.xpn.xwiki.objects.classes.StringClass</classType>
</title>
</class>
<name>MySpase.MyRights</name>
<number>0</number>
<className>MySpase.MyClass</className>
<guid>ddf5f418-8588-4d24-a08d-a6b20f6d4a66</guid>
<property>
<title>X</title>
</property>
</object>
<object>
<class>
<name>XWiki.XWikiRights</name>
<customClass></customClass>
<customMapping></customMapping>
<defaultViewSheet></defaultViewSheet>
<defaultEditSheet></defaultEditSheet>
<defaultWeb></defaultWeb>
<nameField></nameField>
<validationScript></validationScript>
<allow>
<defaultValue>1</defaultValue>
<disabled>0</disabled>
<displayFormType>select</displayFormType>
<displayType>allow</displayType>
<name>allow</name>
<number>4</number>
<prettyName>Allow/Deny</prettyName>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>
</allow>
<groups>
<cache>0</cache>
<disabled>0</disabled>
<displayType>input</displayType>
<multiSelect>1</multiSelect>
<name>groups</name>
<number>1</number>
<picker>1</picker>
<prettyName>Groups</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<size>5</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>
</groups>
<levels>
<cache>0</cache>
<disabled>0</disabled>
<displayType>select</displayType>
<multiSelect>1</multiSelect>
<name>levels</name>
<number>2</number>
<prettyName>Levels</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<size>3</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>
</levels>
<users>
<cache>0</cache>
<disabled>0</disabled>
<displayType>input</displayType>
<multiSelect>1</multiSelect>
<name>users</name>
<number>3</number>
<picker>1</picker>
<prettyName>Users</prettyName>
<relationalStorage>0</relationalStorage>
<separator> </separator>
<size>5</size>
<unmodifiable>0</unmodifiable>
<classType>com.xpn.xwiki.objects.classes.UsersClass</classType>
</users>
</class>
<name>MySpase.MyRights</name>
<number>0</number>
<className>XWiki.XWikiRights</className>
<guid>6b9be2f8-9da3-4a39-8be3-182bc481804d</guid>
<property>
<allow>1</allow>
</property>
<property>
<groups></groups>
</property>
<property>
<levels>view</levels>
</property>
<property>
<users>XWiki.Admin</users>
</property>
</object>
<content>{{velocity}}
#############
## FORM
#############
#macro(showForm)

  {{html}}
  &lt;form action="$doc.getURL()" method="get"&gt;
    &lt;input type="hidden" name="action" value = "post" /&gt;
    &lt;input type="text" name="content" /&gt;
    &lt;input type="submit" /&gt;
  &lt;/form&gt;
  {{/html}}

#end

#############
## ACTION
#############
#macro(perform)
  #if($request.action == "post")
    #set($user = $context.user)
    #set($rights = $doc.getObject('XWiki.XWikiRights', true))
    $rights.set("levels", "view")
    $rights.set("users", $user)
    $rights.set("allow", 1)
    #set($obj = $doc.newObject("MySpase.MyClass"))
    $obj.set("title", $request.content)
    $doc.save()
  #end 
#end

##################
## VIEW
##################
#showForm()
#perform()
#set($array = $doc.getObject('MySpase.MyClass'))
$array
{{/velocity}}</content></xwikidoc>